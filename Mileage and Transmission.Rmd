---
title: "Mileage and Transmission"
author: "Aseem Rohatgi"
output: pdf_document
---

```{r setup, include=F}
knitr::opts_chunk$set(echo=F, fig.align="center")
library(ggplot2)
library(dplyr)
```

# Overview

We at *Motor Trend* looked at a collection of cars and explored the relationship between a set of variables describing the car and miles per gallon that the car achieved. Particularly, we were interested in answering the following two questions:
+ “Is an automatic or manual transmission better for MPG”
+ "Quantify the MPG difference between automatic and manual transmissions"

We found that 
+
+

# Data

We used the data we collected on 32 automobiles('73 & '74 models). We have stored the data in a data frame called `mtcars`. Let's look at a summary of it.

```{r summary}
summary(cbind(mtcars[,-c(2,8:11)],
              cyl=as.factor(mtcars[,2]),
              vs=as.factor(mtcars[,8]),
              am=as.factor(mtcars[,9]),
              gear=as.factor(mtcars[,10]),
              carb=as.factor(mtcars[,11])))
```

We are interested in the how MPG, stored in the variable `mpg`, change with the transmission type, stored in the variable `am` as 0 for automatic, and 1 for manual. Let's look at a boxplot for the data.

```{r boxplot, fig.width=3, fig.height=3}
ggplot(mtcars) + geom_boxplot(aes(x=factor(am), y=mpg, fill=factor(am))) +
  labs(x="Transmission", fill="am", y="MPG") + theme(legend.position="none")
```

This initial look at the data suggests that there is an obvious relationship between the transmission type of the automobile and miles per gallon that it achieves. We performed regression analysis to solidify our intuition with statistical significance.

# Analysis

## Assessing if there is a difference

First, we performed a t-test to provide a solid statistical background to our observation of difference in mileage obtained from the two transmission types. The test provided a p-value of `r t.test(mpg~am,data=mtcars)$p.value`, suggesting a strong difference between the means of `mpg` under the two forms of transmission. Our estimates were `r t.test(mpg~am,data=mtcars)$estimate[1]` for automatic transmission, and `r t.test(mpg~am,data=mtcars)$estimate[2]` for manual(See Appendix for detailed code). Thus, we concluded that automobiles with a manual transmission provide a better mileage than those with an automatic transmission.

```{r t-test, include=F}
t.test(mpg~am,data=mtcars)
```

## Quantifying the difference

To answer our second question of quantifying our result, we performed a regression analysis on `mpg` with `am` as a regressor. Our model was fairly robust as can be seen from the following diagnostic plots.

```{r mdl1 plot, fig.width=5, fig.height=5}
par(mfcol=c(2,2))
mdl1<-lm(mpg~factor(am),mtcars)
plot(mdl1)
mtext("Diagnostics for model mpg~am", side=3, outer=T, line=-16.5,cex=1.5)
```

However, our model was only able to explain about a third of the variance in `mpg`, as is evidenced by the $R^2$ value of `r summary(mdl1)$r.squared`. Hence, we began adding more variables in our model to explain more of the variance, while also making sure that the results we obtained were significant.

```{r mdl2(am+)}
mdl2<-list()
for(i in c(2:8,10,11)){
  if(i %in% c(2,8,10,11))
    mdl2[[i]]<-lm(mpg~factor(am)+factor(mtcars[,i]),mtcars)
  else 
    mdl2[[i]]<-lm(mpg~factor(am)+mtcars[,i],mtcars)
}
```

There were 4 variables which, when added to the model, raised the adjusted $R^2$ to above 70% - `cyl`,`disp`,`hp` and `wt`. These represented the number of cylinders, the displacement, the gross horsepower, and the weight of the automobile. After performing an Analysis of Deviance using different models(adding the variables in different order), we concluded that addition of `cyl`, `wt` and `hp` was effective in increasing the effectiveness of our model.
Thus our final model contains 4 regressors.